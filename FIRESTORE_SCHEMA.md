# Firestore Schema Design: Events Collection

This document outlines the schema for the `events` collection in Firestore, designed to support the Dynamic TX Entertainment platform.

## Collection: `events`

Each document in this collection represents a unique concert or event.

### Fields

| Field Name | Data Type | Requirement | Description | Constraints / Notes |
| :--- | :--- | :--- | :--- | :--- |
| `id` | String | Required (Auto) | Unique identifier for the event document. | Auto-generated by Firestore. |
| `title` | String | Required | The name of the event. | Max length: 150 chars. |
| `artistNames` | Array\<String\> | Optional | List of artists or performers. | Indexed for array-contains search. |
| `eventDate` | Timestamp | Required | The date and time of the event start. | Stored as UTC. Used for sorting. |
| `venue` | Map | Required | Venue details. | Structured object for consistency. |
| &nbsp;&nbsp;`venue.name` | String | Required | Name of the venue. | e.g., "Payne Arena". |
| &nbsp;&nbsp;`venue.city` | String | Required | City location. | e.g., "Hidalgo". |
| &nbsp;&nbsp;`venue.state` | String | Required | State location. | e.g., "TX". |
| &nbsp;&nbsp;`venue.location` | GeoPoint | Optional | Coordinates for map integration. | |
| `description` | String | Optional | Detailed description of the event. | Supports rich text or plain text. |
| `ticketPrice` | Map | Required | Pricing information. | |
| &nbsp;&nbsp;`ticketPrice.min` | Number | Required | Minimum ticket price. | Double/Float. Non-negative. |
| &nbsp;&nbsp;`ticketPrice.max` | Number | Optional | Maximum ticket price. | Double/Float. Non-negative. |
| &nbsp;&nbsp;`ticketPrice.currency`| String | Required | Currency code. | Default: "USD". |
| `availability` | Map | Required | Ticket availability tracking. | |
| &nbsp;&nbsp;`availability.total` | Number | Required | Total capacity/tickets. | Integer. Non-negative. |
| &nbsp;&nbsp;`availability.remaining`| Number | Required | Tickets left for sale. | Integer. Non-negative. |
| &nbsp;&nbsp;`availability.isSoldOut`| Boolean | Derived | Quick flag for UI display. | `true` if `remaining <= 0`. |
| `images` | Map | Optional | Visual assets. | |
| &nbsp;&nbsp;`images.posterUrl` | String | Required | Main promotional poster. | Valid URL. |
| &nbsp;&nbsp;`images.backgroundUrl`| String | Optional | Hero background image. | Valid URL. |
| `category` | String | Optional | Event type classification. | Enum: "Concert", "Comedy", "Festival", "Family". |
| `tags` | Array\<String\> | Optional | Keywords for search/filtering. | e.g., ["Rock", "80s", "Latin"]. |
| `links` | Map | Optional | External URLs. | |
| &nbsp;&nbsp;`links.tickets` | String | Required | Direct link to buy tickets. | Valid URL (Ticketmaster, etc.). |
| &nbsp;&nbsp;`links.website` | String | Optional | Official event website. | Valid URL. |
| `organizer` | Map | Optional | Organizer contact info. | |
| &nbsp;&nbsp;`organizer.name` | String | Optional | Name of the organizing body. | |
| &nbsp;&nbsp;`organizer.email` | String | Optional | Contact email. | Valid Email format. |
| `metadata` | Map | Required | System metadata. | |
| &nbsp;&nbsp;`metadata.createdAt` | Timestamp | Required | Creation time. | Server timestamp. |
| &nbsp;&nbsp;`metadata.updatedAt` | Timestamp | Required | Last modification time. | Server timestamp. |
| &nbsp;&nbsp;`metadata.isPublished`| Boolean | Required | Visibility toggle. | Default: `false` (Draft). |

### JSON Example

```json
{
  "id": "3A006123D8854749",
  "title": "Jeff Dunham: Artificial Intelligence",
  "artistNames": ["Jeff Dunham"],
  "eventDate": "2026-01-31T19:00:00Z",
  "venue": {
    "name": "Payne Arena",
    "city": "Hidalgo",
    "state": "TX",
    "location": {
      "latitude": 26.0969,
      "longitude": -98.2636
    }
  },
  "description": "The world-renowned ventriloquist brings his new tour...",
  "ticketPrice": {
    "min": 71.94,
    "max": 86.00,
    "currency": "USD"
  },
  "availability": {
    "total": 5500,
    "remaining": 120,
    "isSoldOut": false
  },
  "images": {
    "posterUrl": "https://storage.googleapis.com/.../jeff_dunham.webp",
    "backgroundUrl": "https://storage.googleapis.com/.../jeff_bg.jpg"
  },
  "category": "Comedy",
  "tags": ["Comedy", "Ventriloquist", "Payne Arena"],
  "links": {
    "tickets": "https://www.ticketmaster.com/event/3A006123D8854749"
  },
  "metadata": {
    "createdAt": "2025-01-08T10:00:00Z",
    "updatedAt": "2025-01-08T10:00:00Z",
    "isPublished": true
  }
}
```

## Security Rules Implications

1.  **Public Read:** Anyone can read documents where `metadata.isPublished == true`.
2.  **Admin Write:** Only authenticated users with `admin` role can create/update/delete.
3.  **Validation:** Rules should enforce types (e.g., `ticketPrice.min` must be a number).

---

## Collection: `newsletter`

Stores newsletter subscribers from the landing page signup form.

### Fields

| Field Name | Data Type | Requirement | Description | Constraints / Notes |
| :--- | :--- | :--- | :--- | :--- |
| `email` | String | Required | Subscriber's email address. | Lowercase, 5-255 chars. |
| `subscribedAt` | Timestamp | Required | When the user subscribed. | Server timestamp. |
| `source` | String | Optional | Where the signup came from. | e.g., "landing_page", "checkout". |
| `status` | String | Required | Subscription status. | Enum: "active", "unsubscribed". |

### JSON Example

```json
{
  "email": "fan@example.com",
  "subscribedAt": "2025-01-08T15:30:00Z",
  "source": "landing_page",
  "status": "active"
}
```

### Security Rules

1. **Public Read:** Anyone can read to check for duplicate subscriptions.
2. **Public Create:** Anyone can subscribe (validated).
3. **Admin Update/Delete:** Only authenticated users can modify/remove subscribers.
