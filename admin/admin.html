<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CKRTCSV8QH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-CKRTCSV8QH');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Dynamic TX Entertainment</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="../css/admin.css">
</head>

<body class="admin-body">
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <p>Loading...</p>
        </div>
    </div>

    <div class="admin-layout" id="admin-app" style="display: none;">
        <!-- Header -->
        <header class="admin-header">
            <div class="admin-header-left">
                <a href="../index.html" class="logo">
                    <img src="../assets/dtxent-logo.png" alt="DTXENT Logo" class="logo-img">
                </a>
                <nav class="admin-nav">
                    <a href="admin.html" class="admin-nav-link active">Events</a>
                    <a href="users.html" class="admin-nav-link">Users</a>
                    <a href="settings.html" class="admin-nav-link">Settings</a>
                </nav>
            </div>
            <div class="admin-header-right">
                <span class="admin-user" id="admin-email"></span>
                <button class="btn btn-secondary btn-sm" id="logout-btn">Logout</button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="admin-main">
            <div class="page-header">
                <h1>Events</h1>
                <button class="btn btn-primary" id="add-event-btn">+ Add Event</button>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Events</div>
                    <div class="stat-value" id="stat-total">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Upcoming</div>
                    <div class="stat-value" id="stat-upcoming">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Past</div>
                    <div class="stat-value" id="stat-past">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Drafts</div>
                    <div class="stat-value" id="stat-drafts">0</div>
                </div>
            </div>

            <!-- Filter Toolbar -->
            <div class="filter-toolbar">
                <div class="filter-row">
                    <input type="text" id="filter-search" class="filter-input"
                        placeholder="Search artists, events, venues...">
                    <select id="filter-status" class="filter-select">
                        <option value="all">All Status</option>
                        <option value="published">Published</option>
                        <option value="draft">Draft</option>
                    </select>
                    <select id="filter-venue" class="filter-select">
                        <option value="all">All Venues</option>
                    </select>
                    <select id="filter-sort" class="filter-select">
                        <option value="date-asc">Date (Earliest)</option>
                        <option value="date-desc">Date (Latest)</option>
                        <option value="artist-az">Artist A-Z</option>
                        <option value="artist-za">Artist Z-A</option>
                        <option value="recent">Recently Added</option>
                    </select>
                </div>
                <div class="filter-row">
                    <label class="filter-date-label">From</label>
                    <input type="date" id="filter-date-from" class="filter-input filter-date">
                    <label class="filter-date-label">To</label>
                    <input type="date" id="filter-date-to" class="filter-input filter-date">
                    <label class="filter-checkbox-label">
                        <input type="checkbox" id="select-all-checkbox"> Select All
                    </label>
                    <button class="btn btn-secondary btn-sm" id="clear-filters-btn">Clear Filters</button>
                </div>
            </div>

            <!-- No Results State -->
            <div id="no-results-state" class="no-results-state" style="display: none;">
                <p>No matching events found. Try adjusting your filters.</p>
            </div>

            <!-- Events List -->
            <div id="events-list" class="events-admin-grid">
                <!-- Events will be rendered here -->
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="empty-state" style="display: none;">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1"
                        d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                <h3>No Events Yet</h3>
                <p>Create your first event to get started.</p>
                <button class="btn btn-primary" id="add-first-event-btn">+ Add Event</button>
            </div>
        </main>
    </div>

    <!-- Event Modal -->
    <div id="event-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 id="modal-title">Add Event</h2>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <form id="event-form">
                <div class="modal-body">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="artistName">Artist / Performer <span class="required">*</span></label>
                            <input type="text" id="artistName" name="artistName" required
                                placeholder="e.g., Jeff Dunham">
                        </div>
                        <div class="form-group">
                            <label for="eventName">Event / Tour Name <span class="required">*</span></label>
                            <input type="text" id="eventName" name="eventName" required
                                placeholder="e.g., Artificial Intelligence Tour">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="eventDate">Event Date <span class="required">*</span></label>
                            <input type="date" id="eventDate" name="eventDate" required>
                        </div>
                        <div class="form-group">
                            <label for="performerType">Performer Type</label>
                            <select id="performerType" name="performerType">
                                <option value="Person">Person</option>
                                <option value="MusicGroup">Music Group / Band</option>
                                <option value="Organization">Organization</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="venueName">Venue Name <span class="required">*</span></label>
                        <input type="text" id="venueName" name="venueName" required placeholder="e.g., Payne Arena">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="venueCity">City <span class="required">*</span></label>
                            <input type="text" id="venueCity" name="venueCity" required placeholder="e.g., Hidalgo">
                        </div>
                        <div class="form-group">
                            <label for="venueState">State <span class="required">*</span></label>
                            <select id="venueState" name="venueState" required>
                                <option value="">Select State</option>
                                <option value="TX">Texas (TX)</option>
                                <option value="CA">California (CA)</option>
                                <option value="FL">Florida (FL)</option>
                                <option value="NY">New York (NY)</option>
                                <option value="WA">Washington (WA)</option>
                                <option value="AZ">Arizona (AZ)</option>
                                <option value="NV">Nevada (NV)</option>
                                <option value="CO">Colorado (CO)</option>
                                <option value="NM">New Mexico (NM)</option>
                                <option value="OK">Oklahoma (OK)</option>
                                <option value="LA">Louisiana (LA)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="ticketUrl">Ticket URL <span class="required">*</span></label>
                        <input type="text" id="ticketUrl" name="ticketUrl" required
                            placeholder="https://www.ticketmaster.com/...">
                    </div>

                    <div class="form-group">
                        <label>Additional Event Dates</label>
                        <p class="form-hint">The primary date above is always included.</p>
                        <div id="dates-container" class="dates-container">
                            <!-- Dynamic date items will appear here -->
                        </div>
                        <button type="button" class="btn btn-secondary btn-sm" id="add-date-btn"
                            style="margin-top: 0.5rem;">+ Add Date</button>
                    </div>

                    <div class="form-group">
                        <label>Event Schedule</label>
                        <div id="schedule-container" class="schedule-container">
                            <!-- Dynamic schedule items will appear here -->
                        </div>
                        <button type="button" class="btn btn-secondary btn-sm" id="add-schedule-btn"
                            style="margin-top: 0.5rem;">+ Add Schedule Item</button>
                    </div>

                    <div class="form-group">
                        <label>Event Image</label>

                        <div class="toggle-wrapper" style="margin-bottom: 1rem;">
                            <label class="radio-label"
                                style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                                <input type="radio" name="imageType" value="upload" checked> Upload File
                            </label>
                            <label class="radio-label"
                                style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer; margin-left: 1rem;">
                                <input type="radio" name="imageType" value="url"> External URL
                            </label>
                        </div>

                        <div class="image-upload-area" id="image-upload-area">
                            <input type="file" id="eventImage" name="eventImage" accept="image/*">
                            <img id="image-preview" class="image-preview" alt="Preview">
                            <div class="upload-placeholder" id="upload-placeholder">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1"
                                        d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                                </svg>
                                <p>Click to upload image</p>
                                <small>JPG, PNG, WebP (Max 2MB)</small>
                            </div>
                        </div>

                        <div id="image-url-input" style="display: none;">
                            <input type="text" id="externalImageUrl" name="externalImageUrl"
                                placeholder="https://example.com/image.jpg">
                            <img id="external-image-preview" class="image-preview" alt="Preview"
                                style="display: none; margin-top: 10px;">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="imageAlt">Image Alt Text</label>
                        <input type="text" id="imageAlt" name="imageAlt"
                            placeholder="e.g., Jeff Dunham - Artificial Intelligence">
                    </div>

                    <div class="form-group">
                        <div class="toggle-wrapper">
                            <label class="toggle">
                                <input type="checkbox" id="isPublished" name="isPublished" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="toggle-label">Published (visible on website)</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="toggle-wrapper">
                            <label class="toggle">
                                <input type="checkbox" id="isClosed" name="isClosed">
                                <span class="toggle-slider"></span>
                            </label>
                            <span class="toggle-label">Closed (tickets no longer available)</span>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" id="modal-cancel">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="submit-btn">
                        <span class="btn-text">Save Event</span>
                        <span class="btn-loading" style="display: none;">Saving...</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirm Modal -->
    <div id="delete-modal" class="modal-overlay">
        <div class="modal" style="max-width: 400px;">
            <div class="modal-body">
                <div class="confirm-dialog">
                    <h3>Delete Event?</h3>
                    <p>This action cannot be undone. The event and its image will be permanently deleted.</p>
                    <div class="confirm-actions">
                        <button type="button" class="btn btn-secondary" id="delete-cancel">Cancel</button>
                        <button type="button" class="btn btn-danger" id="delete-confirm">Delete</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bulk Action Toolbar -->
    <div id="bulk-toolbar" class="bulk-toolbar" style="display: none;">
        <span class="bulk-count" id="bulk-count">0 selected</span>
        <button class="btn btn-primary btn-sm" id="bulk-publish-btn">Publish</button>
        <button class="btn btn-secondary btn-sm" id="bulk-unpublish-btn">Unpublish</button>
        <button class="btn btn-danger btn-sm" id="bulk-delete-btn">Delete</button>
        <button class="btn btn-secondary btn-sm" id="bulk-cancel-btn">Cancel</button>
    </div>

    <!-- Bulk Delete Confirm Modal -->
    <div id="bulk-delete-modal" class="modal-overlay">
        <div class="modal" style="max-width: 400px;">
            <div class="modal-body">
                <div class="confirm-dialog">
                    <h3>Delete Selected Events?</h3>
                    <p id="bulk-delete-msg">This action cannot be undone. The selected events and their images will be
                        permanently deleted.</p>
                    <div class="confirm-actions">
                        <button type="button" class="btn btn-secondary" id="bulk-delete-cancel">Cancel</button>
                        <button type="button" class="btn btn-danger" id="bulk-delete-confirm">Delete All</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <script type="module" src="admin.js"></script>
</body>

</html>